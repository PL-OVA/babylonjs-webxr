<html>
    <head>
        <title>Babylon.js sample code</title>
        <script src="https://cdn.babylonjs.com/babylon.js"></script>
    </head>
<body>
  <canvas id="renderCanvas" style="width: 100%; height: 100%;"></canvas>
  <script type="text/javascript">
    let canvas;
    let engine;
    let scene;
    
    window.onload = function() {
      canvas = document.getElementById("renderCanvas");
      engine = new BABYLON.Engine(canvas, true);
           
      scene= createScene();
      addObjects();
      initializeXR();
      
      engine.runRenderLoop(function () {
           if (scene.activeCamera) {
             scene.render();
           }
      });     
    }
   async function initializeXR(){
      const xr = await scene.createDefaultXRExperienceAsync({});
      
      if (!xr.baseExperience) {}
      else {
        xr.baseExperience.featuresManager.enableFeature(BABYLON.WebXRFeatureName.HAND_TRACKING, "latest", {
        xrInput: xr.input
        });
      }
      return scene;
   }
    function addObjects(){    
      const box = BABYLON.MeshBuilder.CreateBox("box", {width: 0.3, height: 0.3, depth: 0.3});
      box.position.x = 0.0;
      box.position.y = 1;
      const boxMaterial = new BABYLON.StandardMaterial("material", scene);
      boxMaterial.diffuseColor = BABYLON.Color3.Random();
      box.material = boxMaterial;
      var sixDofDragBehavior = new BABYLON.SixDofDragBehavior();
      sixDofDragBehavior.allowMultiPointer=false;
      //sixDofDragBehavior.rotateDraggedObject=true;
      sixDofDragBehavior.rotateWithMotionController=false;
      box.addBehavior(sixDofDragBehavior);
      
      const sphere = BABYLON.MeshBuilder.CreatePolyhedron("oct", {type:1,size: 0.15}, scene); 
      sphere.position.x=0.5;
      sphere.position.y=1;
          
      var gizmoManager = new BABYLON.GizmoManager(scene);
      gizmoManager.boundingBoxGizmoEnabled = true;
      gizmoManager.gizmos.boundingBoxGizmo.setEnabledScaling(true,true);
      gizmoManager.gizmos.boundingBoxGizmo.scaleBoxSize=0.04;
      gizmoManager.gizmos.boundingBoxGizmo.rotationSphereSize=0.05;
      gizmoManager.boundingBoxDragBehavior.rotateWithMotionController=false;
      gizmoManager.boundingBoxDragBehavior.allowMultiPointer=false;
      gizmoManager.attachableMeshes = [sphere];
      
      const ground = BABYLON.MeshBuilder.CreateGround("ground", {width: 1, height: 1});
      
    }
    
    function createScene() {
      // This creates a basic Babylon Scene object (non-mesh)
      var scene = new BABYLON.Scene(engine);
      
      // This creates and positions a free camera (non-mesh)
      //var camera = new BABYLON.FreeCamera("camera1", new BABYLON.Vector3(0, 2, -0.6), scene);
      scene.clearColor = new BABYLON.Color3.Black;
      
      const alpha = -Math.PI/2;//Math.PI/4;
      const beta = Math.PI/2;;
      const radius = 2;
      const target = new BABYLON.Vector3(0, 0, 0);

      const camera = new BABYLON.ArcRotateCamera("Camera", alpha, beta, radius, target, scene);
      
      // This attaches the camera to the canvas
      camera.attachControl(canvas, true);

      const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(1, 1, 0));
      return scene;
    };
</script>
</body>
</html>